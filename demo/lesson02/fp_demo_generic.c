// triển khai khái quát của fp_demo